<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday Priya ü•∞</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Animated Gradient Background */
body {
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    background: linear-gradient(-45deg, #ff758c, #ff7eb3, #ffafcc, #ffccd5);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    overflow-x: hidden;
}

@keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.container {
    width: 100%;
    max-width: 900px;
    min-height: 90vh;
    position: relative;
    z-index: 1;
}

/* Glowing text effect */
.glow-text {
    text-shadow: 0 0 10px #fff, 0 0 20px #ff3366, 0 0 30px #ff3366;
    animation: glow 2s ease-in-out infinite alternate;
}

@keyframes glow {
    from { text-shadow: 0 0 10px #fff, 0 0 20px #ff3366, 0 0 30px #ff3366; }
    to { text-shadow: 0 0 20px #fff, 0 0 30px #ff3366, 0 0 40px #ff3366; }
}

/* Enhanced screens */
.screen {
    position: absolute;
    width: 100%;
    min-height: 80vh;
    padding: 25px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: all 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(15px);
    border-radius: 25px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.2);
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    margin: auto;
    z-index: 5;
}

.screen.hidden {
    opacity: 0;
    pointer-events: none;
    transform: translateY(50px) scale(0.95);
}

/* INTRO SCREEN ENHANCEMENTS */
#intro {
    background: linear-gradient(135deg, 
        rgba(255, 118, 140, 0.85) 0%, 
        rgba(255, 126, 179, 0.85) 100%);
}

.intro-heart {
    font-size: 4.5rem;
    color: #ff3366;
    margin: 15px 0;
    animation: heartbeat 1.2s infinite ease-in-out, float 3s ease-in-out infinite;
    filter: drop-shadow(0 0 15px rgba(255, 51, 102, 0.7));
    z-index: 6;
}

@keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

.intro-title {
    font-family: 'Dancing Script', cursive;
    font-size: 2.8rem;
    margin-bottom: 15px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    line-height: 1.2;
    animation: fadeInUp 1s ease-out;
}

/* ENHANCED CAKE SCREEN */
#cakeScreen {
    background: linear-gradient(135deg, 
        rgba(255, 105, 180, 0.85) 0%, 
        rgba(255, 182, 193, 0.85) 100%);
}

.cake-container {
    position: relative;
    width: 280px;
    height: 280px;
    margin: 20px 0;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

/* Rotating cake layers */
.cake-layer {
    animation: rotateCake 20s linear infinite;
    transform-origin: center bottom;
}

@keyframes rotateCake {
    from { transform: rotateY(0deg); }
    to { transform: rotateY(360deg); }
}

/* Enhanced flame with rainbow colors */
.flame {
    background: radial-gradient(circle at 50% 30%, 
        #ffde59, #ff9500 40%, 
        #ff3366 60%, #6a11cb 80%, 
        transparent 90%);
    animation: flicker 0.3s infinite alternate,
               rainbowFlame 3s linear infinite;
}

@keyframes rainbowFlame {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
}

/* FINAL SCREEN ENHANCEMENTS */
#final {
    background: linear-gradient(135deg, 
        rgba(255, 20, 147, 0.85) 0%, 
        rgba(255, 105, 180, 0.85) 100%);
}

.final-card {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    padding: 30px 25px;
    width: 100%;
    max-width: 600px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.3);
    animation: cardFloat 4s ease-in-out infinite;
}

@keyframes cardFloat {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    25% { transform: translateY(-5px) rotate(0.5deg); }
    75% { transform: translateY(5px) rotate(-0.5deg); }
}

/* ENHANCED BUTTONS */
.btn {
    background: linear-gradient(45deg, #ff3366, #ff758c);
    color: white;
    border: none;
    padding: 16px 35px;
    font-size: 1.2rem;
    border-radius: 50px;
    cursor: pointer;
    margin-top: 20px;
    font-weight: 600;
    transition: all 0.4s ease;
    box-shadow: 0 10px 20px rgba(255, 51, 102, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: auto;
    min-width: 220px;
    position: relative;
    z-index: 10;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.3), 
        transparent);
    transition: 0.5s;
}

.btn:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 30px rgba(255, 51, 102, 0.6);
    background: linear-gradient(45deg, #ff758c, #ff3366);
}

.btn:hover::before {
    left: 100%;
}

.btn:active {
    transform: translateY(0) scale(0.98);
}

/* WISH COUNTER */
.wish-counter {
    background: rgba(255, 255, 255, 0.2);
    padding: 15px 25px;
    border-radius: 20px;
    margin: 20px 0;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    gap: 15px;
    animation: pulse 2s infinite;
}

.counter-number {
    font-size: 2rem;
    font-weight: bold;
    color: #ffde59;
    text-shadow: 0 0 10px rgba(255, 222, 89, 0.5);
    min-width: 60px;
}

/* MUSIC SELECTOR */
.music-selector {
    position: fixed;
    bottom: 15px;
    left: 15px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 15px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.music-option {
    background: rgba(255, 255, 255, 0.15);
    border: none;
    color: white;
    padding: 10px 15px;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem;
}

.music-option:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateX(5px);
}

.music-option.active {
    background: rgba(255, 51, 102, 0.6);
    box-shadow: 0 0 15px rgba(255, 51, 102, 0.5);
}

/* VOLUME CONTROL */
.volume-control {
    position: fixed;
    bottom: 15px;
    right: 15px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 15px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 10px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.volume-slider {
    width: 100px;
    -webkit-appearance: none;
    appearance: none;
    height: 6px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
    outline: none;
}

.volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #ff3366;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(255, 51, 102, 0.5);
}

/* ENHANCED FLOATING ELEMENTS */
.floating-element {
    position: fixed;
    font-size: 22px;
    opacity: 0.9;
    z-index: 100;
    animation: floatEnhanced 15s linear infinite;
    pointer-events: none;
    filter: drop-shadow(0 0 8px currentColor);
}

@keyframes floatEnhanced {
    0% {
        transform: translateY(100vh) rotate(0deg) scale(0.5);
        opacity: 0;
    }
    10% {
        opacity: 0.9;
        transform: translateY(90vh) rotate(20deg) scale(0.8);
    }
    50% {
        opacity: 0.8;
        transform: translateY(50vh) rotate(180deg) scale(1.2);
    }
    90% {
        opacity: 0.6;
        transform: translateY(10vh) rotate(340deg) scale(0.9);
    }
    100% {
        transform: translateY(-100px) rotate(360deg) scale(0.7);
        opacity: 0;
    }
}

/* FIREWORKS */
.firework {
    position: fixed;
    width: 5px;
    height: 5px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 99;
    animation: fireworkExplode 1s ease-out forwards;
}

@keyframes fireworkExplode {
    0% {
        transform: translate(var(--x), var(--y)) scale(0);
        opacity: 1;
    }
    100% {
        transform: translate(var(--x-end), var(--y-end)) scale(1);
        opacity: 0;
    }
}

/* SPARKLE CURSOR */
.sparkle-cursor {
    position: fixed;
    width: 20px;
    height: 20px;
    pointer-events: none;
    z-index: 10000;
    background: radial-gradient(circle, 
        #ffde59 0%, 
        #ff9500 30%, 
        transparent 70%);
    border-radius: 50%;
    mix-blend-mode: screen;
    animation: sparklePulse 0.5s ease-in-out infinite alternate;
}

@keyframes sparklePulse {
    from { transform: scale(0.8); opacity: 0.7; }
    to { transform: scale(1.2); opacity: 1; }
}

/* LOADING SCREEN */
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.5s ease-out;
}

.loading-screen.hidden {
    opacity: 0;
    pointer-events: none;
}

.loader {
    width: 80px;
    height: 80px;
    border: 8px solid rgba(255, 255, 255, 0.2);
    border-top: 8px solid #ff3366;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* RAINBOW MODE TOGGLE */
.rainbow-toggle {
    position: fixed;
    top: 15px;
    left: 15px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    border: 1px solid rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.rainbow-toggle:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

.rainbow-toggle.active {
    background: linear-gradient(45deg, 
        #ff0000, #ff9900, #ffff00, 
        #00ff00, #0099ff, #6633ff);
    animation: rainbowToggle 2s linear infinite;
}

@keyframes rainbowToggle {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
}

/* DAY/NIGHT TOGGLE */
.theme-toggle {
    position: fixed;
    top: 70px;
    left: 15px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    border: 1px solid rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.theme-toggle:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
    .screen {
        padding: 20px 15px;
        min-height: 75vh;
    }
    
    .intro-title {
        font-size: 2.2rem;
    }
    
    .cake-container {
        width: 240px;
        height: 240px;
    }
    
    .music-selector {
        bottom: 80px;
        left: 50%;
        transform: translateX(-50%);
        flex-direction: row;
        width: 90%;
        justify-content: center;
    }
    
    .volume-control {
        bottom: 80px;
        right: 50%;
        transform: translateX(50%);
    }
    
    .rainbow-toggle,
    .theme-toggle {
        position: absolute;
        top: 10px;
        left: 10px;
        padding: 8px 15px;
        font-size: 0.8rem;
    }
    
    .theme-toggle {
        top: 60px;
    }
}

/* PERFORMANCE MODE */
.performance-mode .floating-element:nth-child(n+20) {
    display: none;
}

.performance-mode .screen {
    backdrop-filter: blur(5px);
}
</style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <h2 style="margin-top: 20px;">Loading Birthday Magic...</h2>
        <div class="loading-progress" style="width: 200px; height: 4px; background: rgba(255,255,255,0.2); margin-top: 10px; border-radius: 2px; overflow: hidden;">
            <div id="progressBar" style="height: 100%; background: #ff3366; width: 0%; transition: width 0.3s;"></div>
        </div>
    </div>

    <!-- Controls -->
    <div class="rainbow-toggle" id="rainbowToggle">
        <i class="fas fa-palette"></i>
        <span>Rainbow Mode</span>
    </div>
    
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
        <span>Dark Mode</span>
    </div>

    <!-- Music Controls -->
    <div class="music-control" id="musicControl">
        <i class="fas fa-play" id="musicIcon"></i>
    </div>
    
    <div class="music-selector" id="musicSelector">
        <button class="music-option active" data-track="1">
            <i class="fas fa-music"></i> Birthday
        </button>
        <button class="music-option" data-track="2">
            <i class="fas fa-heart"></i> Love Song
        </button>
        <button class="music-option" data-track="3">
            <i class="fas fa-star"></i> Celebrations
        </button>
    </div>
    
    <div class="volume-control">
        <i class="fas fa-volume-down"></i>
        <input type="range" min="0" max="100" value="40" class="volume-slider" id="volumeSlider">
        <i class="fas fa-volume-up"></i>
    </div>

    <!-- Sparkle Cursor -->
    <div class="sparkle-cursor" id="sparkleCursor"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Intro Screen -->
        <div id="intro" class="screen">
            <div class="intro-heart">
                <i class="fas fa-heart"></i>
            </div>
            <h1 class="intro-title glow-text">A Beautiful Soul Was Born Today</h1>
            <p class="intro-text" style="font-size: 1.2rem; margin: 15px 0;">
                <span class="glow-text" style="font-size: 1.4rem; color: #ffde59;">25</span> years ago, the world became brighter.<br>
                Because on this day, <span class="glow-text" style="color: #ffde59;">Priya</span> came into existence.<br><br>
                This is a celebration of <span style="font-weight: 600; color: #ffde59;">YOU</span> ‚ú®
            </p>
            
            <!-- Wish Counter -->
            <div class="wish-counter">
                <i class="fas fa-birthday-cake"></i>
                <span>Birthday Wishes:</span>
                <div class="counter-number" id="wishCount">0</div>
                <i class="fas fa-plus" onclick="addWish()" style="cursor: pointer;"></i>
            </div>
            
            <div class="birthday-date" style="font-size: 1.1rem;">
                <i class="fas fa-calendar-alt"></i>
                <span>Dec 20, 2025</span>
            </div>
            
            <button class="btn" onclick="showCakeScreen()">
                <i class="fas fa-gift"></i> Open Your Surprise
            </button>
            
            <!-- Click Instructions -->
            <p style="margin-top: 20px; font-size: 0.9rem; opacity: 0.8;">
                <i class="fas fa-magic"></i> Click anywhere for fireworks!
            </p>
        </div>

        <!-- Cake Screen -->
        <div id="cakeScreen" class="screen hidden">
            <h1 class="intro-title glow-text">Make a Wish, Priya!</h1>
            <div class="cake-container">
                <div class="cake">
                    <div class="candle">
                        <div class="wick"></div>
                        <div id="flame" class="flame"></div>
                    </div>
                    <div class="layer-top cake-layer"></div>
                    <div class="icing"></div>
                    <div class="layer-middle cake-layer"></div>
                    <div class="layer-bottom cake-layer"></div>
                </div>
            </div>
            <p style="font-size: 1.2rem; margin: 20px 0; color: #ffde59;">
                Blow out the candle for your special message! ‚ú®
            </p>
            <div class="button-container">
                <button class="btn" onclick="blowCandle()">
                    <i class="fas fa-wind"></i> Blow Out Candle
                </button>
                <button class="btn" style="background: linear-gradient(45deg, #6a11cb, #2575fc);" onclick="showIntro()">
                    <i class="fas fa-arrow-left"></i> Go Back
                </button>
            </div>
        </div>

        <!-- Final Screen -->
        <div id="final" class="screen hidden">
            <div class="final-card">
                <h1 class="final-title glow-text">Happy 25th Birthday! üéâ</h1>
                
                <!-- Name Animation -->
                <div style="font-size: 2.5rem; font-family: 'Dancing Script'; margin: 20px 0; color: #ffde59;">
                    <span class="name-letter">P</span>
                    <span class="name-letter">r</span>
                    <span class="name-letter">i</span>
                    <span class="name-letter">y</span>
                    <span class="name-letter">a</span>
                </div>
                
                <div id="messageContainer" class="final-message">
                    <!-- Messages will appear here -->
                </div>
                
                <div class="signature" style="font-size: 2rem; margin: 25px 0;">
                    With all my love ‚ù§Ô∏è
                </div>
                
                <button class="btn" onclick="restartCelebration()">
                    <i class="fas fa-redo"></i> Watch Again
                </button>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="bgMusic1" loop preload="auto">
        <source src="https://assets.mixkit.co/music/preview/mixkit-happy-birthday-to-you-443.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="bgMusic2" loop preload="auto">
        <source src="https://assets.mixkit.co/music/preview/mixkit-love-song-for-a-special-occasion-505.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="bgMusic3" loop preload="auto">
        <source src="https://assets.mixkit.co/music/preview/mixkit-celebration-553.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="candleSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-candle-blow-738.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="fireworkSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-fireworks-show-audio-1540.mp3" type="audio/mpeg">
    </audio>

<script>
// DOM Elements
const introScreen = document.getElementById('intro');
const cakeScreen = document.getElementById('cakeScreen');
const finalScreen = document.getElementById('final');
const flame = document.getElementById('flame');
const messageContainer = document.getElementById('messageContainer');
const loadingScreen = document.getElementById('loadingScreen');
const progressBar = document.getElementById('progressBar');
const sparkleCursor = document.getElementById('sparkleCursor');
const wishCountElement = document.getElementById('wishCount');
const rainbowToggle = document.getElementById('rainbowToggle');
const themeToggle = document.getElementById('themeToggle');
const volumeSlider = document.getElementById('volumeSlider');

// Audio elements
const bgMusic1 = document.getElementById('bgMusic1');
const bgMusic2 = document.getElementById('bgMusic2');
const bgMusic3 = document.getElementById('bgMusic3');
const candleSound = document.getElementById('candleSound');
const clickSound = document.getElementById('clickSound');
const fireworkSound = document.getElementById('fireworkSound');

// Music tracking
let currentTrack = 1;
let bgMusic = bgMusic1;
let musicPlaying = false;
let musicInitialized = false;

// Enhanced birthday messages
const birthdayMessages = [
    "My Dearest Priya,\n\nToday marks 25 beautiful years of your incredible journey! üéÇ",
    
    "You are the sunshine that brightens every room, the laughter that fills every silence, and the love that warms every heart. ‚ú®",
    
    "May this special day be filled with joy, laughter, and moments you'll cherish forever! üåà",
    
    "Here's to another year of dreams coming true, adventures unfolding, and endless happiness! ü•Ç",
    
    "Happy 25th Birthday! May your life always be as wonderful and beautiful as you are! üíñ"
];

// State variables
let currentMessageIndex = 0;
let wishCount = 0;
let rainbowMode = false;
let darkMode = false;
let floatingElementsInterval;
let heartCount = 0;

// Simulate loading
function simulateLoading() {
    let progress = 0;
    const interval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 100) {
            progress = 100;
            clearInterval(interval);
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                createFloatingElements();
                createSparkleCursor();
            }, 500);
        }
        progressBar.style.width = progress + '%';
    }, 200);
}

// Create floating elements with enhanced effects
function createFloatingElements() {
    clearInterval(floatingElementsInterval);
    
    // Create initial batch
    for (let i = 0; i < 25; i++) {
        setTimeout(() => createFloatingElement(), i * 200);
    }
    
    // Continuous creation
    floatingElementsInterval = setInterval(() => {
        if (heartCount < 40) {
            createFloatingElement();
            if (Math.random() > 0.7) createTrailEffect();
        }
    }, 1000);
}

function createFloatingElement() {
    const element = document.createElement('div');
    element.className = 'floating-element';
    
    const symbols = ['‚ù§Ô∏è', '‚ú®', 'üéÇ', 'üéÅ', 'üéà', 'ü•≥', 'üéâ', 'üåü'];
    const colors = ['#ff3366', '#ff66a3', '#ffde59', '#6a11cb', '#00ffaa', '#ff9500'];
    
    element.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
    element.style.color = colors[Math.floor(Math.random() * colors.length)];
    element.style.left = Math.random() * 100 + 'vw';
    element.style.fontSize = (Math.random() * 12 + 18) + 'px';
    element.style.animationDuration = (Math.random() * 5 + 12) + 's';
    element.style.animationDelay = Math.random() * 2 + 's';
    
    if (rainbowMode) {
        element.style.animationName = 'floatEnhanced, rainbowFlame';
    }
    
    document.body.appendChild(element);
    heartCount++;
    
    setTimeout(() => {
        if (element.parentNode) {
            element.parentNode.removeChild(element);
            heartCount--;
        }
    }, 20000);
}

function createTrailEffect() {
    const trail = document.createElement('div');
    trail.className = 'floating-element';
    trail.innerHTML = '‚úß';
    trail.style.color = '#ffffff';
    trail.style.opacity = '0.5';
    trail.style.fontSize = '12px';
    trail.style.left = Math.random() * 100 + 'vw';
    trail.style.animationDuration = '8s';
    
    document.body.appendChild(trail);
    
    setTimeout(() => {
        if (trail.parentNode) trail.parentNode.removeChild(trail);
    }, 10000);
}

// Create sparkle cursor
function createSparkleCursor() {
    document.addEventListener('mousemove', (e) => {
        sparkleCursor.style.left = e.clientX + 'px';
        sparkleCursor.style.top = e.clientY + 'px';
        
        if (Math.random() > 0.7) {
            createSparkle(e.clientX, e.clientY);
        }
    });
    
    document.addEventListener('touchmove', (e) => {
        const touch = e.touches[0];
        sparkleCursor.style.left = touch.clientX + 'px';
        sparkleCursor.style.top = touch.clientY + 'px';
        
        if (Math.random() > 0.5) {
            createSparkle(touch.clientX, touch.clientY);
        }
    });
}

function createSparkle(x, y) {
    const sparkle = document.createElement('div');
    sparkle.className = 'floating-element';
    sparkle.innerHTML = '‚ú¶';
    sparkle.style.color = '#ffde59';
    sparkle.style.fontSize = '16px';
    sparkle.style.left = x + 'px';
    sparkle.style.top = y + 'px';
    sparkle.style.animationDuration = '1.5s';
    sparkle.style.animationName = 'floatEnhanced';
    
    document.body.appendChild(sparkle);
    
    setTimeout(() => {
        if (sparkle.parentNode) sparkle.parentNode.removeChild(sparkle);
    }, 2000);
}

// Create fireworks
function createFirework(x, y) {
    playClickSound();
    fireworkSound.currentTime = 0;
    fireworkSound.play().catch(() => {});
    
    const particles = 50;
    const colors = ['#ff3366', '#ffde59', '#6a11cb', '#00ffaa', '#ff9500'];
    
    for (let i = 0; i < particles; i++) {
        const particle = document.createElement('div');
        particle.className = 'firework';
        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        particle.style.setProperty('--x', x + 'px');
        particle.style.setProperty('--y', y + 'px');
        particle.style.setProperty('--x-end', (Math.random() * 400 - 200) + 'px');
        particle.style.setProperty('--y-end', (Math.random() * 400 - 200) + 'px');
        
        document.body.appendChild(particle);
        
        setTimeout(() => {
            if (particle.parentNode) particle.parentNode.removeChild(particle);
        }, 1000);
    }
}

// Add wish counter
function addWish() {
    wishCount++;
    wishCountElement.textContent = wishCount;
    wishCountElement.style.transform = 'scale(1.3)';
    setTimeout(() => {
        wishCountElement.style.transform = 'scale(1)';
    }, 300);
    
    // Create wish animation
    const wish = document.createElement('div');
    wish.innerHTML = '‚ú®';
    wish.style.position = 'fixed';
    wish.style.fontSize = '2rem';
    wish.style.color = '#ffde59';
    wish.style.left = '50%';
    wish.style.top = '50%';
    wish.style.transform = 'translate(-50%, -50%) scale(0)';
    wish.style.transition = 'all 0.5s ease-out';
    wish.style.zIndex = '1000';
    
    document.body.appendChild(wish);
    
    setTimeout(() => {
        wish.style.transform = 'translate(-50%, -50%) scale(2)';
        wish.style.opacity = '0';
    }, 10);
    
    setTimeout(() => {
        if (wish.parentNode) wish.parentNode.removeChild(wish);
    }, 600);
}

// Name letter animation
function animateName() {
    const letters = document.querySelectorAll('.name-letter');
    letters.forEach((letter, index) => {
        setTimeout(() => {
            letter.style.display = 'inline-block';
            letter.style.animation = 'bounce 0.5s ease';
            setTimeout(() => {
                letter.style.animation = '';
            }, 500);
        }, index * 200);
    });
}

// Screen transitions
function showCakeScreen() {
    playClickSound();
    introScreen.classList.add('hidden');
    setTimeout(() => {
        cakeScreen.classList.remove('hidden');
        animateName();
    }, 300);
}

function showIntro() {
    playClickSound();
    cakeScreen.classList.add('hidden');
    setTimeout(() => {
        introScreen.classList.remove('hidden');
    }, 300);
}

// Blow candle with enhanced effects
function blowCandle() {
    playClickSound();
    
    candleSound.currentTime = 0;
    candleSound.play().catch(() => {});
    
    // Enhanced spark effects
    for (let i = 0; i < 8; i++) {
        setTimeout(() => {
            createSparkle(
                window.innerWidth / 2 + (Math.random() * 100 - 50),
                window.innerHeight / 2 + (Math.random() * 100 - 50)
            );
        }, i * 100);
    }
    
    // Flame animation
    flame.classList.add('off');
    flame.style.animation = 'none';
    
    // Smoke effect
    for (let i = 0; i < 5; i++) {
        setTimeout(() => {
            const smoke = document.createElement('div');
            smoke.style.position = 'absolute';
            smoke.style.width = '20px';
            smoke.style.height = '20px';
            smoke.style.background = 'radial-gradient(circle, rgba(150,150,150,0.8) 0%, transparent 70%)';
            smoke.style.borderRadius = '50%';
            smoke.style.left = '50%';
            smoke.style.top = '50%';
            smoke.style.transform = 'translate(-50%, -50%) scale(0)';
            smoke.style.animation = `smokeRise ${Math.random() * 0.5 + 1}s ease-out forwards`;
            
            document.styleSheets[0].insertRule(`
                @keyframes smokeRise {
                    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
                    100% { transform: translate(${Math.random() * 100 - 50}px, -200px) scale(2); opacity: 0; }
                }
            `, 0);
            
            cakeScreen.querySelector('.cake-container').appendChild(smoke);
            
            setTimeout(() => {
                if (smoke.parentNode) smoke.parentNode.removeChild(smoke);
            }, 1500);
        }, i * 200);
    }
    
    // Show final screen
    setTimeout(() => {
        cakeScreen.classList.add('hidden');
        setTimeout(() => {
            finalScreen.classList.remove('hidden');
            typeMessage();
            createFireworksBurst();
            animateName();
        }, 500);
    }, 1500);
}


// Type message with enhanced effects
function typeMessage() {
    messageContainer.innerHTML = '';
    currentMessageIndex = 0;
    
    function typeNextCharacter() {
        if (currentMessageIndex < birthdayMessages.length) {
            const currentMessage = birthdayMessages[currentMessageIndex];
            let charIndex = 0;
            
            function typeChar() {
                if (charIndex < currentMessage.length) {
                    let displayedText = '';
                    for (let i = 0; i <= currentMessageIndex; i++) {
                        if (i < currentMessageIndex) {
                            displayedText += birthdayMessages[i] + '\n\n';
                        } else {
                            displayedText += currentMessage.substring(0, charIndex + 1);
                        }
                    }
                    
                    messageContainer.innerHTML = displayedText + '<span class="typing-cursor"></span>';
                    
                    // Add typing sound effect (optional)
                    if (charIndex % 3 === 0) {
                        clickSound.currentTime = 0;
                        clickSound.play().catch(() => {});
                    }
                    
                    charIndex++;
                    setTimeout(typeChar, 40);
                } else {
                    currentMessageIndex++;
                    setTimeout(typeNextCharacter, 800);
                }
            }
            
            typeChar();
        } else {
            messageContainer.innerHTML = birthdayMessages.join('\n\n');
            messageContainer.style.textAlign = 'justify';
        }
    }
    
    typeNextCharacter();
}

// Create fireworks burst
function createFireworksBurst() {
    for (let i = 0; i < 10; i++) {
        setTimeout(() => {
            createFirework(
                Math.random() * window.innerWidth,
                Math.random() * window.innerHeight
            );
        }, i * 300);
    }
}

// Restart celebration
function restartCelebration() {
    playClickSound();
    flame.classList.remove('off');
    flame.style.animation = 'flicker 0.3s infinite alternate, rainbowFlame 3s linear infinite';
    finalScreen.classList.add('hidden');
    setTimeout(() => {
        introScreen.classList.remove('hidden');
        wishCount = 0;
        wishCountElement.textContent = '0';
    }, 500);
}

// Music functions
function initializeMusic() {
    bgMusic1.volume = volumeSlider.value / 100;
    bgMusic2.volume = volumeSlider.value / 100;
    bgMusic3.volume = volumeSlider.value / 100;
    candleSound.volume = 0.5;
    clickSound.volume = 0.4;
    fireworkSound.volume = 0.3;
    
    musicInitialized = true;
}

function toggleMusic() {
    playClickSound();
    
    if (!musicInitialized) {
        initializeMusic();
    }
    
    if (musicPlaying) {
        bgMusic.pause();
        musicPlaying = false;
    } else {
        bgMusic.play().then(() => {
            musicPlaying = true;
        }).catch(() => {
            showNotification("Click to enable music");
        });
    }
    
    updateMusicIcon();
}

function updateMusicIcon() {
    const icon = document.getElementById('musicIcon');
    const control = document.getElementById('musicControl');
    if (musicPlaying) {
        icon.className = 'fas fa-pause';
        control.classList.add('active');
    } else {
        icon.className = 'fas fa-play';
        control.classList.remove('active');
    }
}

function changeMusic(track) {
    playClickSound();
    if (musicPlaying) {
        bgMusic.pause();
    }
    
    currentTrack = track;
    bgMusic = document.getElementById(`bgMusic${track}`);
    bgMusic.currentTime = 0;
    
    if (musicPlaying) {
        bgMusic.play();
    }
    
    // Update active button
    document.querySelectorAll('.music-option').forEach(btn => {
        btn.classList.remove('active');
        if (parseInt(btn.dataset.track) === track) {
            btn.classList.add('active');
        }
    });
    
    updateMusicIcon();
}

function updateVolume() {
    const volume = volumeSlider.value / 100;
    bgMusic1.volume = volume;
    bgMusic2.volume = volume;
    bgMusic3.volume = volume;
    candleSound.volume = volume * 0.5;
    clickSound.volume = volume * 0.4;
    fireworkSound.volume = volume * 0.3;
}

// Toggle rainbow mode
function toggleRainbowMode() {
    rainbowMode = !rainbowMode;
    rainbowToggle.classList.toggle('active');
    
    if (rainbowMode) {
        document.body.style.animation = 'gradientBG 5s ease infinite';
        document.body.style.background = 'linear-gradient(-45deg, #ff0000, #ff9900, #ffff00, #00ff00, #0099ff, #6633ff)';
        document.body.style.backgroundSize = '600% 600%';
    } else {
        document.body.style.animation = 'gradientBG 15s ease infinite';
        document.body.style.background = 'linear-gradient(-45deg, #ff758c, #ff7eb3, #ffafcc, #ffccd5)';
        document.body.style.backgroundSize = '400% 400%';
    }
}

// Toggle dark mode
function toggleDarkMode() {
    darkMode = !darkMode;
    const icon = themeToggle.querySelector('i');
    const text = themeToggle.querySelector('span');
    
    if (darkMode) {
        icon.className = 'fas fa-sun';
        text.textContent = 'Light Mode';
        document.body.style.filter = 'brightness(0.7) contrast(1.2)';
    } else {
        icon.className = 'fas fa-moon';
        text.textContent = 'Dark Mode';
        document.body.style.filter = 'none';
    }
}

// Play click sound
function playClickSound() {
    clickSound.currentTime = 0;
    clickSound.play().catch(() => {});
}

// Show notification
function showNotification(text) {
    const notification = document.getElementById('musicNotification');
    if (notification) {
        notification.textContent = text;
        notification.classList.add('show');
        setTimeout(() => notification.classList.remove('show'), 2000);
    }
}

// Initialize everything
window.onload = function() {
    simulateLoading();
    
    // Initialize music
    initializeMusic();
    
    // Event listeners
    document.getElementById('musicControl').addEventListener('click', toggleMusic);
    
    document.querySelectorAll('.music-option').forEach(btn => {
        btn.addEventListener('click', () => {
            changeMusic(parseInt(btn.dataset.track));
        });
    });
    
    volumeSlider.addEventListener('input', updateVolume);
    rainbowToggle.addEventListener('click', toggleRainbowMode);
    themeToggle.addEventListener('click', toggleDarkMode);
    
    // Click anywhere for fireworks
    document.addEventListener('click', (e) => {
        if (e.target.tagName !== 'BUTTON' && e.target.id !== 'wishCount') {
            createFirework(e.clientX, e.clientY);
        }
    });
    
    // Touch for mobile
    document.addEventListener('touchstart', (e) => {
        const touch = e.touches[0];
        createFirework(touch.clientX, touch.clientY);
    });
    
    // Auto-start music on first interaction
    document.addEventListener('click', function autoStartMusic() {
        if (!musicInitialized) {
            initializeMusic();
            changeMusic(1);
            musicPlaying = true;
            updateMusicIcon();
        }
        document.removeEventListener('click', autoStartMusic);
    }, { once: true });
    
    // Handle page visibility
    document.addEventListener('visibilitychange', () => {
        if (document.hidden && musicPlaying) {
            bgMusic.pause();
        } else if (!document.hidden && musicPlaying) {
            bgMusic.play().catch(() => {});
        }
    });
    
    // Prevent zoom on double-tap
    document.addEventListener('dblclick', (e) => {
        e.preventDefault();
    }, { passive: false });
    
    // Add initial wishes
    wishCount = 25; // Starting with 25 for 25th birthday
    wishCountElement.textContent = wishCount;
};
</script>
</body>
</html>
